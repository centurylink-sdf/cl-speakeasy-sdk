define(["jquery","ApiLoader"],function(e,t){function i(){t.load("SpeakEasy","0.1.4",function(e,t){if(e)console.log("Error loading SpeakEasy"),console.log(e);else{console.log("SpeakEasy has been loaded"),console.log("Running SpeakEasy v"+t.version());var n=document.getElementById("confDestination"),r=document.getElementById("btnMakeCall"),i=document.getElementById("btnEndCall"),u=document.getElementById("btnStartVideo"),a=document.getElementById("btnStopVideo"),f=document.getElementById("btnHoldCall"),l=document.getElementById("btnUnHoldCall");t.CallManager.setup({localVideoContainer:"localVideo",remoteVideoContainer:"remoteVideo"}),t.CallManager.onCallReceived=function(e){var t=confirm("Incoming call! Would you like to answer?");t===!0?e.answer(function(){o("Call is answered!")},function(){s("Call couldn't be answered!")}):e.reject(function(){o("Call is rejected!")},function(){s("Call couldn't be rejected!")})},r.addEventListener("click",function(e){var r=n.value;t.CallManager.createCall(r,!1,function(e){e.onStateChanged=function(t){switch(t){case e.events.CALL_STARTED:o("Call is started!");break;case e.events.CALL_ENDED:o("Call was ended on other side!");break;case e.events.CALL_HELD:o("Call was held on other side!");break;case e.events.CALL_REJECTED:o("Call was rejected!")}}})}),i.addEventListener("click",function(e){var n=t.CallManager.getCurrentCall();n.hangUp(function(){o("Call is ended!")},function(){s("Call couldn't be ended!")})}),u.addEventListener("click",function(e){var n=t.CallManager.getCurrentCall();n.startVideo(function(){o("Video is started!")},function(){s("Video couldn't be started!")})}),a.addEventListener("click",function(e){var n=t.CallManager.getCurrentCall();n.stopVideo(function(){o("Video is stopped!")},function(){s("Video couldn't be stopped!")})}),f.addEventListener("click",function(e){var n=t.CallManager.getCurrentCall();n.hold(function(){o("Call is held!")},function(){s("Call couldn't be held!")})}),l.addEventListener("click",function(e){var n=t.CallManager.getCurrentCall();n.unhold(function(){o("Call is resumed!")},function(){s("Call couldn't be resumed!")})})}})}function s(e){f(e,"alert alert-danger")}function o(e){f(e,"alert alert-info")}function u(e){f(e,"alert alert-success")}function a(e){f(e,"alert alert-warning")}function f(e,t){var n=document.getElementById("logContainer"),r=document.createElement("div");r.className=t,r.innerHTML=e,n.insertBefore(r,n.firstChild)}var n=e(".btn-login"),r=e(".btn-logout");t.Auth.isAuthenticated()?i():window.location.href="index.html"});